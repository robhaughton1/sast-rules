## Rule Template
   - id: 
    message: 
    severity:
    languages: 
    pattern:

   rules:
    -id:  python-string-concatenation
    message: Avoid concatenating $X and $Y. For cleaner code, use f-strings.
    severity: INFO
    languages: [python]
    pattern: $X + $Y

    -id: no-eval # name of the rule being created
    message: Avoid using eval() — it can lead to code injection vulnerabilities.
    severity: WARNING 
    languages: [javascript] 
    pattern: eval($X)

    
    -id: no-child-exec
      message: child_process.exec() executes shell commands and may allow command injection. Avoid passing untrusted input.
      severity: WARNING
      languages: [javascript]
      pattern: child_process.exec($CMD) 

    -id: no-xss
    message: Avoid inputting user input inside res.send or XSS sinks, use context appropriate sanitization.
    severity: HIGH
    languages: [javascript]
    pattern-either:
       - pattern: res.send($SRC)
       - pattern: res.write($SRC)
       - pattern: res.end($SRC)
    pattern-not:
      - pattern: res.send(sanitize($SRC)) 
      - pattern: res.write(sanitize($SRC))
      - pattern: res.end(sanitize($SRC))

    -id: no-innerhtml
    message: Using innerHTML can introduce XSS vulnerabilities 
    severity: WARNING
    languages: [javascript]
    pattern: $EL.innerHTML = $X

   - id: no-document-write
    message: Avoid using document.write(), it can lead to DOM XSS
    severity: WARNING
    languages: [javascript]
    pattern: document.write($SRC)

   - id: no-string-timers
    message: Avoid passing strings to timers, can lead to arbitrary code injection
    severity: WARNING
    languages: [javascript]
    pattern: setTimeout($SRC, $T)

  - id: no-hardcoded-password
    message: Hardcoded password detected — use environment variables or a secrets manager
    severity: ERROR
    languages: [javascript, python]
    patterns:
      - pattern-regex: (?i)(password|passwd|pwd)\s*=\s*['"].+['"]

  - id: no-open-redirect
    message: User-controlled navigation detected - validate or allowlist correct redirect targets
    severity: WARNING
    languages: [javascript]
    patterns:
      - pattern-either
         - pattern:
            window.location = $SRC
         - pattern: 
            location.href = $SRC  
         - pattern: 
            document.location = $SRC

  - id: no-command-injection
    message: Use of child_process.exec spawns a shell, which could lead to Command Injection. Use execFIle or strict allowlisting
    severity: WARNING
    languages: [javascript]
    patterns:
       - pattern-either:
          - pattern: exec($X)
          - pattern: execSync($X)

  - id: no-new-function
    message: Avoid creating functions from new strings, this executes code dynamically and can lead to injection
    severity: WARNING
    languages: [javascript]
    patterns: 
      - pattern-either:
         - pattern: newFunction($X)



